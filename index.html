<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Final Evolution: Digi‑Dex</title>
  <meta name="color-scheme" content="dark light">
  <style>
    :root{
      --bg:#0b1020; --panel:#101735; --panel-2:#0d1330; --text:#e9ecf7; --muted:#9aa3c4;
      --brand:#59a6ff; --accent:#ffd166; --chip:#1e2a54; --ring:#1b2547; --ok:#31d0aa; --warn:#ff7a7a;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    html,body{margin:0;height:100%;background:var(--bg);color:var(--text);font:16px/1.55 system-ui,Segoe UI,Roboto,Inter,Arial}
    a{color:var(--brand);text-decoration:none}
    a:hover{text-decoration:underline}

    /* NAVBAR */
    .nav{
      position:sticky; top:0; z-index:50;
      background:linear-gradient(180deg,#0b1020,rgba(11,16,32,.72));
      border-bottom:1px solid var(--ring);
      backdrop-filter: blur(10px);
    }
    .nav-inner{max-width:1200px;margin:auto;padding:12px 18px;display:flex;align-items:center;gap:16px}
    .brand{display:flex;gap:10px;align-items:center;font-weight:800;letter-spacing:.3px}
    .brand .logo{
      width:28px;height:28px;border-radius:7px;background:
        radial-gradient(120% 120% at 20% 20%, #5ac8ff 0%, #2441ff 38%, #0b1020 80%);
      box-shadow: 0 0 0 1px #2b3772 inset, 0 4px 16px rgba(36,65,255,.35);
    }
    .nav a.navlink{color:var(--text);text-decoration:none;opacity:.9}
    .nav a.navlink:hover{opacity:1;color:#cfe0ff}
    .spacer{flex:1}

    /* HERO */
    .hero{max-width:1200px;margin:20px auto 8px;padding:0 18px}
    .hero h1{margin:6px 0 6px;font-size:clamp(22px,4vw,36px)}
    .hero p{margin:0;color:var(--muted)}

    /* CONTROLS */
    .panel{max-width:1200px;margin:14px auto;padding:14px 18px}
    .controls{
      background:var(--panel);
      border:1px solid var(--ring); border-radius:16px; box-shadow:var(--shadow);
      display:flex;flex-wrap:wrap;gap:10px; padding:12px;
    }
    .controls input,.controls select{
      background:var(--panel-2);
      border:1px solid var(--ring); color:var(--text);
      padding:10px 12px;border-radius:12px; outline:none;
    }
    .controls input{flex:1 1 280px}
    .controls .hint{color:var(--muted);font-size:12px;margin-left:auto;display:flex;align-items:center}

    /* GRID */
    .grid{max-width:1200px;margin:0 auto 30px;padding:0 18px;display:grid;gap:14px;
      grid-template-columns:repeat(auto-fill,minmax(220px,1fr))}
    .card{
      background:var(--panel);
      border:1px solid var(--ring);
      border-radius:16px; overflow:hidden; box-shadow:var(--shadow);
      transition: transform .15s ease,border-color .2s;
    }
    .card:hover{transform:translateY(-3px); border-color:#2a3d86}
    .thumb{aspect-ratio:1/1; background:#0b132b; display:flex; align-items:center; justify-content:center}
    .thumb img{width:100%;height:100%;object-fit:contain;filter: drop-shadow(0 3px 12px rgba(0,0,0,.45))}
    .body{padding:12px}
    .body h3{margin:0 0 6px;font-size:16px}
    .meta{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:8px}
    .chip{background:var(--chip);color:#b9c6ff;padding:4px 8px;border-radius:999px;font-size:12px}
    .statline{display:flex;gap:12px;color:var(--muted);font-size:12px}
    .card-link{display:block;color:inherit;text-decoration:none}

    /* EMPTY & FOOTER */
    .empty{max-width:1200px;margin:10px auto 30px;padding:0 18px;color:var(--muted)}
    footer{border-top:1px solid var(--ring);color:var(--muted);text-align:center;padding:14px 18px}
    .disclaimer{font-size:12px;color:#8e96b5}
  </style>
</head>
<body>
  <!-- NAV -->
  <nav class="nav">
    <div class="nav-inner">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <span>Final Evolution: <span style="color:#cfe0ff">Digi‑Dex</span></span>
      </div>
      <div class="spacer"></div>
      <a class="navlink" href="./index.html">Home</a>
      <a class="navlink" href="./digimon.html">Digi‑Dex</a>
      <a class="navlink" href="./about.html">About</a>
    </div>
  </nav>

  <!-- HERO -->
  <header class="hero">
    <h1>Guide and Dex for Final Evolution: Digi by Digimon Wolrd Indonesia</h1>
    <p>Masih scratch, hehe, nanti aku kabarin kalau selesai. ttd: Joe :P</p>
  </header>

  <!-- CONTROLS -->
  <section class="panel">
    <div class="controls">
      <input id="q" type="search" placeholder="Cari nama / type / attribute / skill…" />
      <select id="flv" aria-label="Filter level">
        <option value="">Semua Level</option>
        <option>In-Training</option>
        <option>Rookie</option>
        <option>Champion</option>
        <option>Ultimate</option>
        <option>Mega</option>
      </select>
      <select id="fat" aria-label="Filter attribute">
        <option value="">Semua Attribute</option>
        <option>Vaccine</option>
        <option>Data</option>
        <option>Virus</option>
        <option>Free</option>
      </select>
      <select id="sort" aria-label="Urutkan">
        <option value="name-asc">Nama (A–Z)</option>
        <option value="name-desc">Nama (Z–A)</option>
        <option value="atk-desc">ATK tertinggi</option>
        <option value="spd-desc">SPD tertinggi</option>
      </select>
      <div class="hint">⌘/Ctrl + F untuk search cepat</div>
    </div>
  </section>

  <!-- GRID -->
  <main id="grid" class="grid" aria-live="polite"></main>
  <p id="empty" class="empty" hidden>Hmmm… nggak ketemu. Coba ubah kata kunci atau filter ya, Joe~</p>

  <!-- FOOTER -->
  <footer>
    <div>© Final Evolution • Digi‑Dex • Built with ❤️ by Joe</div>
    <div class="disclaimer">Digimon adalah merek dagang milik pemegang hak terkait. Ini proyek penggemar non‑komersial.</div>
  </footer>

  <script>
    // ====== DATA SEMENTARA (bisa diganti fetch('data/digimon.json')) ======
    const SAMPLE = [
      {
        id: "agumon",
        name: "Agumon",
        level: "Rookie",
        type: "Reptile",
        attribute: "Vaccine",
        element: ["Fire"],
        skills: [{name:"Pepper Breath"}],
        stats: {hp: 620, atk: 140, def: 90, spd: 110, int: 80},
        image: "./assets/images/digimon/agumon.webp"
      },
      {
        id: "greymon",
        name: "Greymon",
        level: "Champion",
        type: "Dinosaur",
        attribute: "Vaccine",
        element: ["Fire"],
        skills: [{name:"Mega Flame"}],
        stats: {hp: 980, atk: 220, def: 160, spd: 120, int: 100},
        image: "./assets/images/digimon/greymon.webp"
      },
      {
        id: "metalgreymon",
        name: "MetalGreymon",
        level: "Ultimate",
        type: "Cyborg",
        attribute: "Vaccine",
        element: ["Fire","Metal"],
        skills: [{name:"Giga Destroyer"}],
        stats: {hp: 1320, atk: 300, def: 240, spd: 140, int: 120},
        image: "./assets/images/digimon/metalgreymon.webp"
      },
      {
        id: "wargreymon",
        name: "WarGreymon",
        level: "Mega",
        type: "Dragon Warrior",
        attribute: "Vaccine",
        element: ["Fire","Earth"],
        skills: [{name:"Terra Force"}],
        stats: {hp: 1680, atk: 380, def: 300, spd: 170, int: 160},
        image: "./assets/images/digimon/wargreymon.webp"
      }
    ];

    // ====== UTIL ======
    const $ = (id) => document.getElementById(id);
    function sorter(key){
      const m = {
        'name-asc': (a,b)=> a.name.localeCompare(b.name),
        'name-desc':(a,b)=> b.name.localeCompare(a.name),
        'atk-desc': (a,b)=> (b.stats?.atk||0)-(a.stats?.atk||0),
        'spd-desc': (a,b)=> (b.stats?.spd||0)-(a.stats?.spd||0),
      };
      return m[key] || m['name-asc'];
    }
    function textIncludes(hay, term){
      return (hay||'').toLowerCase().includes(term);
    }

    // ====== RENDER ======
    const grid = $('grid'), empty = $('empty');
    const q = $('q'), flv = $('flv'), fat = $('fat'), sortSel = $('sort');

    // Ganti ke true untuk load dari file JSON eksternal
    const USE_EXTERNAL_JSON = false;

    async function loadData(){
      if (!USE_EXTERNAL_JSON) return SAMPLE;
      const res = await fetch('./data/digimon.json', {cache:'no-store'});
      if (!res.ok) throw new Error('Gagal memuat data');
      return await res.json();
    }

    function cardHTML(d){
      const src = d.image || './assets/images/digimon/placeholder.webp';
      const elements = (d.element||[]).map(e=>`<span class="chip">${e}</span>`).join('');
      return `
        <a class="card-link" href="./digimon.html#${encodeURIComponent(d.id)}" aria-label="Buka detail ${d.name}">
          <article class="card">
            <div class="thumb"><img src="${src}" alt="${d.name}" loading="lazy"></div>
            <div class="body">
              <h3>${d.name}</h3>
              <div class="meta">
                <span class="chip">${d.level}</span>
                <span class="chip">${d.attribute}</span>
                ${elements}
              </div>
              <div class="statline">
                <span>ATK: ${d.stats?.atk ?? '-'}</span>
                <span>SPD: ${d.stats?.spd ?? '-'}</span>
              </div>
            </div>
          </article>
        </a>
      `;
    }

    function render(list){
      grid.innerHTML = list.map(cardHTML).join('');
      empty.hidden = list.length > 0;
    }

    function applyFilters(data){
      const term = (q.value||'').trim().toLowerCase();
      const level = flv.value;
      const attr = fat.value;
      const sort = sorter(sortSel.value);

      let out = data.filter(d=>{
        const okLevel = !level || d.level === level;
        const okAttr  = !attr || d.attribute === attr;
        const hay = [
          d.name, d.id, d.level, d.type, d.attribute,
          ...(d.element||[]),
          ...((d.skills||[]).map(s=>s.name))
        ].join(' | ').toLowerCase();
        const okTerm = !term || textIncludes(hay, term);
        return okLevel && okAttr && okTerm;
      }).sort(sort);

      return out;
    }

    let DB = [];

    async function init(){
      try {
        DB = await loadData();
        render(applyFilters(DB));
        [q, flv, fat, sortSel].forEach(el => el.addEventListener('input', () => {
          render(applyFilters(DB));
        }));
      } catch (e){
        console.error(e);
        grid.innerHTML = `<p style="color:#ff9aa2">Error: ${e.message}</p>`;
      }
    }

    init();
  </script>
</body>
</html>
